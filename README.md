# cs6035-web-security-solved
**TO GET THIS SOLUTION VISIT:** [CS6035 Web Security Solved](https://www.ankitcodinghub.com/product/cs6035-web-security-solved/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;102011&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;5&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;5&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;5\/5 - (5 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;CS6035 Web Security Solved&quot;,&quot;width&quot;:&quot;138&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 138px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            5/5 - (5 votes)    </div>
    </div>
<h4><strong>2025 SPRING WEBSECURITY SOLUTION <a href="https://www.ankitcodinghub.com/product/cs6035-web-security-project-2025-solved/"><span style="color: #ff0000;">CLICK HERE</span></a></strong></h4>
<h4><strong>2024 SUMMER WEBSECURITY SOLUTION <a href="https://www.ankitcodinghub.com/product/web-security-cs6035-2024-solved-wip-flag4/"><span style="color: #ff0000;">CLICK HERE</span></a></strong></h4>
<h1><a name="_Toc17258"></a>The goals of this project:</h1>
<ul>
<li>Students are asked to read up on web security basics and write simple web vulnerabilities using Javascript/HTML</li>
<li>A series of warm up activities will help ease students into the assignment</li>
<li>With their knowledge of web security, the students are expected to attack three targets using the following web exploits:</li>
<li>Target 1 ‚Äì Cross-Site Request Forgery (XSRF)</li>
<li>Target 2 ‚Äì Cross Site Scripting (XSS)</li>
<li>Target 3 ‚Äì SQL Injection (SQLi)</li>
<li>Read Ed ‚Äì Lots of questions are answered there daily. Be sure to check there before asking a question. Note: We will not review code in private posts so please don‚Äôt post these.</li>
</ul>
<h1><a name="_Toc17259"></a>Intro:</h1>
Congratulations! You just started your first day at your summer internship at Red Team Inc., a penetration testing company that specializes in testing customers‚Äô web applications. Your mentor, Jason, introduces himself to you, and lets you know that you‚Äôll be working with him and the rest of his team for the next few weeks doing a penetration test on the payroll site for your own school, Georgia Tech!

To get you up to speed on the skills required to do your job, he starts off by assigning some readings and warm up exercises.

<strong>Prior Reading and Important Notes from your Mentor:</strong>

This project requires submitting forms. If you do not know how to do so, you may consult <a href="http://www.w3schools.com/html/html_forms.asp">http://www.w3schools.com/html/html_forms.asp</a>

This project requires writing JavaScript. Only a very basic knowledge of JavaScript is needed. You may find <a href="http://eloquentjavascript.net/">http://eloquentjavascript.net/</a> useful if you are completely new to JavaScript. Even if not completely new, you may find chapters 13 (JavaScript and the Browser), 14 (The Document Object Model), 15 (Handling Events), and 18 (HTTP and Forms) particularly useful.

You are <u>required </u>to use the provided templates for all parts of this project.

<strong><u>You are NOT submitting any PHP code in this project</u>. </strong>Thus, your exploits should not modify the provided PHP files on the VM besides for debugging purposes. If you do happen to modify the PHP files, make sure you revert your changes when you test your exploit. We test your exploits using your submitted .html files and run them against the original, unmodified payroll server provided in the VM. This is a common mistake our interns make, so please make sure to use the original files to test your final exploits.

This project will require you to read and understand PHP (PHP Hypertext Preprocessor), which runs on a web server and responds to HTTP requests with dynamically generated pages and responses. It essentially works by taking template HTML files and filling them in by running scripts embedded in the template.

<strong>Getting Your Development Machine Set Up:</strong>

<strong>NOTE: </strong>The project uses the same exact VM that you used for Malware Analysis. If you already have that up and running there is <u>no need </u>to download it again. The link here is provided only if you wish to download it again.

Link: <a href="https://cs6035.s3.amazonaws.com/cs6035_p2_p3_p4_spring2023.ova">https://cs6035.s3.amazonaws.com/cs6035_p2_p3_p4_spring2023.ova </a>Use the same username and password you used for project 2:

<table width="295">
<tbody>
<tr>
<td width="149">Username</td>
<td width="145">Password</td>
</tr>
<tr>
<td width="149">debian</td>
<td width="145">debian</td>
</tr>
</tbody>
</table>
<strong>Helpful Hints from your Mentor:</strong>

<ul>
<li>The primary site we will be exploiting in this project is http://payroll.gatech.edu, which you can only visit on the VM. Please note again that this does not point to a legitimate site in the real world and only exists in the VM. For testing purposes, you may register accounts at your will. However, please DO NOT use your actual passwords and banking account information.</li>
<li>The developers for the website have <em>tried </em>to implement some safeguards to protect against some common web exploits. However, these may or may not be effective, and part of your role will be to audit the correctness of their safeguards.</li>
<li>The source code of the site can be found on the VM in /var/www/payroll. There is a bookmark added to the file manager to make your job a bit easier.</li>
<li>You will be using the Chrome browser to complete all portions of this project. <strong><em>Do not use Firefox</em></strong>. It will fail on some targets and you‚Äôll waste a ton of time.</li>
</ul>
<strong><u>Use Chrome for this project!</u></strong>

<strong>Disclaimer:</strong>

This project is solely for educational purposes. Professor Wenke Lee and the people affiliated with his teaching and research are NOT responsible in the event of any criminal charges brought against any individuals misusing the information in this project to break the law. When in doubt, please consult the TAs or Professor Lee regarding any questions or issues you may have.

<strong><em>We hope you enjoy this challenging yet rewarding project. Now onto the details!</em></strong>

<h1><a name="_Toc17260"></a>Warm Up Exercises ‚Äì (30 points)</h1>
To get you up to speed with web development, your mentor, Jason, has assigned you the following guided learning questions. He tells you to complete these and then report back to him so he can start assigning you tasks. He reminds you about the resources he provided to you earlier. You might find those useful when answering these questions.

<h3>1.a ‚Äì Basic HTML &amp; PHP Questions (<u>Ungraded </u>but very helpful)</h3>
Your mentor explains that you should be able to answer the following questions before starting the projects. If you come to his desk and ask him any of these questions, he‚Äôll refer you to this writeup üôÇ

<ul>
<li>Describe what HTML is (including what it stands for). What is its role in a website?</li>
<li>What does PHP stand for, and how is it used? What is the difference between basic HTML and PHP?</li>
<li>What is the delineator for PHP code (i.e., how does the PHP interpreter know when there is server-side code to run)?</li>
<li>What is SQL? What is its purpose, and with what is it used to communicate?</li>
<li>How does SQL work in a website? Where is the SQL command executed?&nbsp; Is it done in HTML or in PHP?</li>
<li>What is the DOM? What does that stand for?&nbsp; How does HTML support DOM and how do you access it?&nbsp; How does JavaScript use the DOM and do things with it?</li>
</ul>
<h3>1.b ‚Äì Getting to know the browser dev tools</h3>
You‚Äôll be using the <u>Chrome </u>browser to solve all problems in this project. The goal is to get you more familiar with the built-in browser developer tools. Chrome is installed in the VM and ready for you to use.

<h4><strong>Activity 1 ‚Äì The Inspector &amp; Console tabs (</strong><strong>6 </strong><strong>points)</strong></h4>
The goal of this activity is to familiarize you with the basic html inspector (‚Äòelements‚Äô tab) and console of the browser tools. To access these tools click F12 or use the menus within the browser to bring them up.

Launch <u>Chrome </u>and navigate to this URL ‚Üí <a href="http://cs6035-warmup.gatech.edu:5000/tools">http://cs6035-warmup.gatech.edu:5000/tools </a>Note: The URL only works in the VM.

Use the inspector (elements tab) and console tabs to answer the following questions about this login screen. <u>Note: You don‚Äôt actually log in</u>. The page that shows up at the link IS the site you should use to answer the questions below. You are <u>required </u>to use this template when submitting your answers. This will be autograded so the template is required. <a href="https://drive.google.com/file/d/1aKj5c33TFEBEc0kxOt1sWRaMTzuJK2Aj/view?usp=sharing">https://drive.google.com/file/d/1aKj5c33TFEBEc0kxOt1sWRaMTzuJK2Aj/view?usp=sharing</a>

<ol>
<li>What is the value of the ‚ÄòCanYouSeeMe‚Äô input?
<ul>
<li><em>Do not include quotes in your answer.</em></li>
</ul>
</li>
<li>The page references a single JavaScript file in a script tag. Name this file including the file extension.
<ul>
<li>Do not include the path, just the file and extension. Ex: ajavascriptfile.js</li>
</ul>
</li>
</ol>
‚óã <em>Do not include quotes in your answer.</em>

<ol start="3">
<li>The script file has a JavaScript function named ‚Äòrunme‚Äô. Use the console to <u>execute </u>this function. What is the output that shows up in the console? ‚óã <em>Do not include quotes in your answer.</em></li>
</ol>
<strong>activity1.html </strong>(linked above) looks like this when you open it in a browser. Edit this file and replace Your Answer Here with your answer. Note: Do not include quotes around the answer. Submit this file with your answers.

<h4><strong>Activity 2 ‚Äì Network Tab (</strong><strong>6 </strong><strong>points)</strong></h4>
The goal of this activity is to familiarize you with the network activity between the browser and the server. Use the network tab to understand how HTTP requests are sent to the server and what types of data come back in the responses. You are <u>required </u>to use this template when submitting your answers. This will be autograded so the template is required. <a href="https://drive.google.com/file/d/1-aX8FjmrsgQ6VCpt7mNixD7zVZ44mykv/view?usp=sharing">https://drive.google.com/file/d/1-aX8FjmrsgQ6VCpt7mNixD7zVZ44mykv/view?usp=sharing</a>

Step 1: Launch <u>Chrome </u>and navigate to this URL ‚Üí <a href="http://cs6035-warmup.gatech.edu:5000/tools">http://cs6035-warmup.gatech.edu:5000/tools </a>Open the network tab.

Step 2: Click on the ‚ÄòSign In‚Äô button. No need to provide any credentials, leave them blank. Use the network tab to answer the following questions.

<ol>
<li>What request method (HTTP verb) was used in the request to the server?
<ul>
<li><em>Do not include quotes in your answer.</em></li>
</ul>
</li>
<li>What status code did the server return? ‚óã Include just the code. Ex: 200
<ul>
<li><em>Do not include quotes in your answer.</em></li>
</ul>
</li>
<li>The server returned a cookie named ‚ÄòJWT‚Äô for the browser to store. What is the value of this cookie?
<ul>
<li><em>Do not include quotes in your answer.</em></li>
</ul>
</li>
</ol>
<strong>activity2.html </strong>(linked above) looks like this when you open it in a browser. Edit this file and replace Your Answer Here with your answer. Note: Do not include quotes around the answer. Submit this file with your answers.

<h4><strong>Activity 3 ‚Äì Echo XSS (</strong><strong>5 </strong><strong>points)</strong></h4>
The goal of this activity is to ease you into one of the most prominent types of web-based attacks: Reflected XSS (Cross Site Scripting)

Launch <u>Chrome </u>and get ready! You‚Äôve found a webpage that echoes back a query parameter that

you provide in the request to the server. Navigate to this URL to test it out ‚Üí <a href="http://cs6035-warmup.gatech.edu:5000/tools/echo?payload=SampleText">http://cs6035-warmup.gatech.edu:5000/tools/echo?payload=SampleText</a>

<ol>
<li>You can do more than just echo back text. Construct an html page such that a JavaScript alert dialog appears with the text cs6035 on the screen.
<ol>
<li>Note: It is <u>Required </u>that the URL in the browser after opening your file starts with this -&gt; ‚Äúhttp://cs6035-warmup.gatech.edu:5000/tools/echo‚Äù</li>
<li>You will lose all points if the URL doesn‚Äôt start with the string above since this is not actually an XSS attack.</li>
</ol>
</li>
<li>You are <u>required </u>to use this template when submitting your constructed URL. This will be autograded so the template is required.</li>
</ol>
<a href="https://drive.google.com/file/d/1QGJAQFcCICWCLuIu4wU4h774N-YgfruY/view?usp=sharing">https://drive.google.com/file/d/1QGJAQFcCICWCLuIu4wU4h774N-YgfruY/view?usp=sh </a><a href="https://drive.google.com/file/d/1QGJAQFcCICWCLuIu4wU4h774N-YgfruY/view?usp=sharing">aring</a>

<h4>Example of Successful Exploit</h4>
Our autograder is a Selenium script so it will simulate user interaction using the same exact browser and VM that you have. It will do the following for this activity:

<ul>
<li>Launch your activity3.html file</li>
</ul>
<ol>
<li>Only modify the URL value of the HTML template</li>
</ol>
<ul>
<li>Verify that the URL of the page starts with <a href="http://cs6035-warmup.gatech.edu:5000/tools/echo">http://cs6035-warmup.gatech.edu:5000/tools/echo</a></li>
<li>Verify that a <strong>JavaScript alert dialog </strong>shows up on the resulting page with the text cs6035 in it.</li>
</ul>
<strong>1.c ‚Äì Working with HTML forms &amp; JavaScript</strong>

<h3>Activity 4 ‚Äì Submitting forms (5 points)</h3>
The goal of this activity is to familiarize you with HTML forms. You need to construct an html page that will submit a simple form to the server. Complete this activity from within the VM using the <u>Chrome </u>browser.

Here are your requirements for building the html file:

<ul>
<li>The form MUST autosubmit. The autograder will not click any buttons nor will a TA.</li>
<li>The URL that you need to submit your form to ‚Üí <a href="http://cs6035-warmup.gatech.edu:5000/forms">http://cs6035-warmup.gatech.edu:5000/forms</a></li>
<li>You need to POST the form to the server</li>
<li>You need to provide a URL query parameter in your submission
<ul>
<li>IsHoneyPot with a value of false</li>
</ul>
</li>
<li>You need to provide the following form input values
<ul>
<li>Name: ‚ÄòGATechID‚Äô; Value: your Georgia Tech ID, Example: 9101234</li>
</ul>
</li>
</ul>
‚óã Name: ‚ÄòMagicNumber‚Äô; Value: Any number, ex: 5

<ul>
<li>You are <u>required </u>to use this template when submitting your constructed URL. This will be autograded so the template is required.</li>
</ul>
<a href="https://drive.google.com/file/d/1ELWaN92kau78875zgnYOz7Rbx_1vSOKc/view?usp=sharing">https://drive.google.com/file/d/1ELWaN92kau78875zgnYOz7Rbx_1vSOKc/view?usp=sharing </a>Once you successfully submit the form, you‚Äôll see a message similar to the following: <strong><em>‚ÄúCongratulations!, you‚Äôve successfully finished this activity. The answer is &lt;REDACTED&gt;‚Äù</em></strong>

You MUST see this page to receive credit for this activity!

Upload activity4.html which is the form that you constructed.

<h4>Example of Successful Exploit</h4>
Our autograder is a Selenium script so it will simulate user interaction using the same exact browser and VM that you have. It will do the following for this activity:

<ul>
<li>Launch your activity4.html file</li>
</ul>
<ol>
<li>The page MUST autosubmit</li>
</ol>
<ul>
<li>Verify that the URL of the page starts with <a href="http://cs6035-warmup.gatech.edu:5000/">http://cs6035-warmup.gatech.edu:5000</a></li>
<li>Verify that the text ‚ÄúCongratulations!, you‚Äôve successfully finished this activity. The answer is &lt;REDACTED&gt;‚Äù appears in the resulting page.</li>
</ul>
<h3>Activity 5 ‚Äì Accessing the DOM with JavaScript (8 points)</h3>
In this activity you‚Äôll complete a JavaScript function that will utilize the DOM (document object model) to fetch several values in a sample website and print them to the page. This will give you a little insight into how the DOM works and ways you may retrieve these values and trigger/handle events.

<ul>
<li><u>You must use the template provided here. Failure to do so will result in a zero for this section.</u></li>
</ul>
‚ñ† <a href="https://drive.google.com/file/d/1QKD2MGlZqsrg9fmCr60H3fseQ1fdMQ3N/view?usp=sharing">https://drive.google.com/file/d/1QKD2MGlZqsrg9fmCr60H3fseQ1fdMQ3N/view?us </a><a href="https://drive.google.com/file/d/1QKD2MGlZqsrg9fmCr60H3fseQ1fdMQ3N/view?usp=sharing">p=sharing</a>

<ul>
<li>Your task is to write JavaScript in the provided function that meets each goal specified in the comments. Do not change any code outside of this function.</li>
<li>Once completed, your page will look similar to the screenshot below. The values will be different when we grade your function so do not hard-code any value we‚Äôre asking you to fetch with JavaScript.</li>
<li>To get started, simply download the template above. You‚Äôll see a page launch with several TODOs. View the source and begin editing the function provided in the template you downloaded.</li>
</ul>
Example Output Expected:

<h4>Example of Successful Exploit</h4>
Our autograder is a Selenium script so it will simulate user interaction using the same exact browser and VM that you have. It will do the following for this activity:

<ol>
<li>Launch your activity5.html file, Note: you must use our provided template.</li>
<li>Verify that each item in the JavaScript file is correctly displaying on the page.</li>
<li>The order of the items on the page <u>DOES matter</u>. It must look like the screenshot above. If the page is out of order then you‚Äôre missing something or not correctly meeting a requirement.</li>
</ol>
<h1><a name="_Toc17261"></a>Target 1: XSRF (20 points)</h1>
Having completed the warmup tasks Jason assigned (you did do them, right? They‚Äôre a lot of fun), you walk up to him for your first task. He explains that he has discovered a vulnerability in the GT payroll site that he‚Äôd like you to craft a proof-of-concept exploit for. Suppose a user, say Alice, is <u>already logged into </u>the Georgia Tech payroll site located here in the VM -&gt; http://payroll.gatech.edu. He noticed that you can craft a web page so that when Alice visits your web page, she gets redirected (NO popups) to the Georgia Tech payroll page with her account number and routing number set to some values of her choice.

Not wanting you to use your own bank account information (for obvious reasons), Jason tells you to use some information from a script that he wrote.

To fetch your bank account number and routing number, run the <strong>get_bank_info </strong>script inside the VM and pass in your <strong>GTID# </strong>(e.g. 903094111). Example command on the terminal:

debian@debian:~$ get_bank_info 903094111

Here is an example of what the script will print out:

Username: 903094111

Account number: 615421199

Routing number: 3775278306

<strong>NOTE: This is not the Georgia Tech Username, it is the numeric GTID# that you can find on your Buzzcard or here: </strong><a href="https://public.webapps.gatech.edu/cfeis/gtid/"><strong>https://public.webapps.gatech.edu/cfeis/gtid/</strong></a><strong>.</strong>

If you enter the wrong GTID#, which generates a different account and routing number, your exploit will fail our scripts, and you will receive zero points for this part, so be sure to double and triple check.

The user must NOT see the contents of your crafted page! However, a split second due to browser rendering is acceptable. This is because in a real-world attack, the attacker might send this page via email to a user as part of a social engineering attack, and if the user sees the contents of the page it would arouse suspicion. We want the PoC to be as realistic as possible to drive home the point to the client.

<h2><a name="_Toc17262"></a>Deliverables</h2>
<ul>
<li>html</li>
<li>You are <u>required </u>to use this template when submitting your constructed URL. This will be autograded so the template is required.</li>
</ul>
<a href="https://drive.google.com/file/d/1lcL8k_PgfZBegcpMdgtJ-BCszIhnzCyK/view?usp=sharing">https://drive.google.com/file/d/1lcL8k_PgfZBegcpMdgtJ-BCszIhnzCyK/view?usp=sharing</a>

<h4>Milestones</h4>
A successful attack earns 20 points automatically.

If you are unable to complete the task, you will earn partial credit as follows:

<table width="624">
<tbody>
<tr>
<td width="257">Points</td>
<td width="367">Milestone (you earn points in this order)</td>
</tr>
<tr>
<td width="257">10 out of 20 pts</td>
<td width="367">You see the ‚ÄúCSRF attempt prevented!‚Ä¶‚Äù message with your exploit and cannot progress further.</td>
</tr>
<tr>
<td width="257">20 out of 20 pts</td>
<td width="367">Able to change the account number and routing number without extra browser tabs or popups. If you get to this point you‚Äôve earned the full 15 points.

Caution: Double check that the values you use are the ones assigned to you by running get_bank_info. You WILL lose points even if the value is off by one.
</td>
</tr>
</tbody>
</table>
<h4>Notes</h4>
You can visit your web page by entering the path of your file in the browser URL bar. For example, this would be file:///home/user/t1.html assuming that your exploit lives in /home/user/. You can also simply double click to open the file in Chrome. This opens your exploit in another tab but this is OK and it works. Your actual exploit code must NOT open a new tab via JavaScript or other means. You can also open your file using the CTRL+o hotkey.

Do NOT use relative paths for site URLs in your exploits.

<ul>
<li>WRONG -&gt; /somefolder/somefile.php</li>
<li>CORRECT -&gt; http://payroll.gatech.edu/somefile.php</li>
</ul>
We see this every semester from a handful of students. Your exploit will fail, and you will not receive credit.

<h4>Example of Successful Exploit</h4>
Our autograder is a Selenium script so it will simulate button clicks using the same exact browser and VM that you have. It will do the following for Task 1:

<ul>
<li>Log into the site using a known good username and password.</li>
<li>Launch your t1.html file in the same open tab</li>
</ul>
<ol>
<li>It must auto-submit!</li>
</ol>
<ul>
<li>Verify that the URL starts with ‚Äúhttp://payroll.gatech.edu‚Äù</li>
<li>Verify that the Changes Saved is on the page and that the account number and routing number matches <u>your assigned values</u>. Do not use 1234567890 as this is just an example. See the screenshot below.</li>
</ul>
<h1><a name="_Toc17263"></a>Target 2: XSS Username and Password Theft (25 points)</h1>
Now that you‚Äôve finished your PoC exploit for the first vulnerability, Jason thinks you are ready to write one for a potentially more-severe vulnerability. He noticed that you could steal a user‚Äôs username and password. You can craft a web page such that whenever a victim, say Bob, visits the

page (by clicking the attachment in a phishing email), it will redirect him (NO popups) to <a href="http://payroll.gatech.edu/">http://payroll.gatech.edu/</a> with a malicious script injected into the page.

The web page should look as if Bob visited the site directly without going through your page. When Bob enters his login information into the page and clicks Log In, an email with his username and password will be sent. Jason asks you to craft such a PoC web page. You will have to send the email to the local user account on the virtual machine.

This attack requires an email to be sent to user on the system. The good news is that you can use hackmail:

http://hackmail.org/sendmail.php

<u>Open the above URL from within virtual machine </u>for instructions on how to send emails via your attack script. Any mail that the user account receives will appear in /var/mail/user file. A bookmark has been added to the file manager for your convenience. Note: Initially the user file will <u>not </u>be there. Your exploits will cause it to be generated.

<h4>Requirements</h4>
<ul>
<li>The attack must be performed using XSS. Providing a phishing web page will result in 0 points. The browser URL bar should contain the domain payroll.gatech.edu and not a phishing URL. If you find yourself copy and pasting html code from the payroll site into your t2.html then you‚Äôre likely heading down a very wrong path.</li>
<li>The email payload should be the user‚Äôs username (login) and password separated by a single space. i.e. username password &lt;- notice the space!</li>
</ul>
‚óã The sender of the email (look at the screenshot below before asking questions) should be set to

MjAyM1NwcmluZyYmRWFzdGVyRWdnYGBUYXJnZXQyLVRoaXNPbmVDYW5CZUR pZmZpY3VsdF5e

‚óã Failure to follow this format will result in 0 points for this part.

<ul>
<li>The redirected page must be cosmetically identical to the original page. The web page source can be different as long as the user cannot tell without looking at the source. This may take some trial and error. This part can be difficult! Use the developer tools to help you. Extra html characters such as &lt; and &gt; are not ok. Shifted alignments that can be noticed are also not ok. You should be able to hide all traces of your injected script.</li>
<li>The page must be functionally identical. This means the user can log into the site in the normal fashion and will not notice any visual/functional differences. Yes, you must be able to log in to pass this test.</li>
</ul>
<h4>Deliverables</h4>
<ul>
<li>t2.html</li>
</ul>
<h2><a name="_Toc17264"></a>Sample t2.html deliverable:</h2>
You are <u>required </u>to use this template when submitting your constructed URL. This will be autograded so the template is required.

<h2><a name="_Toc17265"></a><a href="https://drive.google.com/file/d/1s5WmU6Ygu8CTl0VfIQeyupr9-CDZ_a6I/view?usp=sharing">https://drive.google.com/file/d/1s5WmU6Ygu8CTl0VfIQeyupr9-CDZ_a6I/view?usp=sharing</a></h2>
<h2><a name="_Toc17266"></a>Milestones</h2>
A successful attack earns 25 points automatically.

If you are unable to complete the task, you will earn partial credit as follows:

<table width="624">
<tbody>
<tr>
<td width="239">Points</td>
<td width="385">Milestone (you earn points in this order)</td>
</tr>
<tr>
<td width="239">10 out of 25 points</td>
<td width="385">Can inject a script and send an email to the user account but cannot progress further</td>
</tr>
<tr>
<td width="239">25 out of 25 points</td>
<td width="385">Steal the user‚Äôs username and password and send them to the user account via email.

Caution: The values need to be exactly correct.

Extra spaces, quotes or anything WILL result in
</td>
</tr>
<tr>
<td width="239"></td>
<td width="385">point loss. The exploited web page must be <strong><u>cosmetically identical </u></strong>to the original website. Hint: your exploit may initially introduce odd styling issues or show characters on the page.

You must hide these.
</td>
</tr>
</tbody>
</table>
<h2><a name="_Toc17267"></a>Notes</h2>
We suggest playing around with hackmail outside of your exploit to make sure you can generate data within the ‚Äúuser‚Äù mail file. Right click it and open with the Text Editor to view the contents. Do not delete the user file. If you do, hackmail will create a new one but you may be required to run Linux commands in order to view the contents. <u>Just don‚Äôt delete it.</u>

Use the developer tools built into Chrome. Simply click F12 in Chrome and you‚Äôll see the dev tools pop up at the bottom. This tool is your friend, get to know it and use it to help you through this task.

<h2><a name="_Toc17268"></a>Example of Successful Exploit</h2>
Our autograder is a Selenium script so it will simulate button clicks using the same exact browser and VM that you have. It will do the following for Task 2:

<ol>
<li>Open your t2.html file
<ol>
<li>It must auto-submit!</li>
</ol>
</li>
<li>Verify that the URL of the page is correct and that it is cosmetically identical to the original site. See screenshot below.</li>
<li>Input a known good username</li>
<li>Input a known good password
<ol>
<li>Note: Your code <u>does not </u>need to handle invalid username and/or password. We‚Äôll only test happy path.</li>
</ol>
</li>
<li>Click the Log In button</li>
<li>Inspect the file system for the user file</li>
<li>Validate that the user file contains username and password and that the sender is</li>
</ol>
MjAyM1NwcmluZyYmRWFzdGVyRWdnYGBUYXJnZXQyLVRoaXNPbmVDYW5CZURpZm ZpY3VsdF5e See screenshot below.

<ol start="8">
<li>Ensures that the user is logged in correctly. Your exploit cannot break the login functionality of the site.</li>
</ol>
After opening t2.html, the resulting web page should look exactly the same as the legitimate site. Notice there are no cosmetic differences! The reason, you ask, is because it IS the payroll site and not a phishing site. Hint: your code needs to inject and redirect to the payroll website. Do not reconstruct a version of the site within t2.html. This is wrong.

The email should be sent via hacker mail.

<h1><a name="_Toc17269"></a>Target 3: SQL Injection (25 points)</h1>
Impressed with how much you‚Äôve learned so far (and in so little time), Jason thinks he can entrust you to create a final PoC HTML webpage with the following requirements to show the website developers how easy it is to bypass their site‚Äôs authentication:

<ul>
<li>The crafted page has a text field for the username and a submit button. ‚óã NO password field!</li>
<li>The user of this page is not logged into Georgia Tech payroll system, but when he or she enters a valid Georgia Tech payroll registered username (for example, judyhopps) and clicks submit, the user is redirected to http://payroll.gatech.edu/account.php and logged in as judyhopps.</li>
<li>Do NOT execute destructive SQL commands such as DROP tables. System administrators can easily detect data loss!</li>
<li>Do not change the id of the input field ‚Äòtargetlogin‚Äô, and the button id ‚Äòexploit‚Äô. This is very important as the autograder specifically looks for these elements. Failure to include them <u>will result in a zero </u>for this target. See the template below.</li>
</ul>
<h2><a name="_Toc17270"></a>Deliverables</h2>
<ul>
<li>t3.html</li>
</ul>
<h2><a name="_Toc17271"></a>Sample t3.html deliverable:</h2>
You are <u>required </u>to use this template when submitting your constructed URL. This will be autograded so the template is required.

<h2><a name="_Toc17272"></a><a href="https://drive.google.com/file/d/1C8CDBSLerl-RQZZAWJm4GH1CVboKwcwN/view?usp=sharing">https://drive.google.com/file/d/1C8CDBSLerl-RQZZAWJm4GH1CVboKwcwN/view?usp=sharing</a></h2>
<h2><a name="_Toc17273"></a>Milestones</h2>
A successful attack earns 25 points automatically (so long as it does not execute destructive SQL commands).

There are no partial credit opportunities for target 3.

If you implement the attack with a destructive SQL command that causes our scripts to fail to grade your target you‚Äôll not receive points for this Task. You will not need to modify the database schema in any way in order to exploit this.

<h2><a name="_Toc17274"></a>Example of Successful Exploit</h2>
Our autograder is a Selenium script so it will simulate button clicks using the same exact browser

and VM that you have. It will do the following for Task 3:

<ol>
<li>Launch your t3.html file in Chrome. See screenshot below.</li>
<li>Find the targetlogin input field and replace whatever text is there with a known good username</li>
<li>Find the exploit submit button and click it</li>
<li>Inspect the resulting redirected page to ensure it is the correct page, see screenshot below, and that the user is successfully logged in.</li>
<li>Ensure that the resulting redirected page is cosmetically &amp; functionally identical to the original site.</li>
</ol>
After visiting t3.html, the page displays an input field for the attacker.

After typing in the username of an existing user in the payroll system, you should be successfully logged in. The site should function as if you are logged in legitimately.

<strong>The final deliverables:</strong>

Log into <strong><u>Gradescope </u></strong>and submit all files. See below for a screenshot.. File names must exactly match and they should not be zipped up.

<strong>Note: Your submission is <u>not autograded in Gradescope </u>like other projects. You will <u>not </u>get feedback until after the project closes and our Selenium autograder is run.</strong>

<h4>Acknowledgements</h4>
<ul>
<li>Special thanks to Professor Vitaly Shmatikov for the inspiration of this project and his permission to modify and reuse his materials. You may find more about him and his research here:</li>
</ul>
<a href="http://www.cs.cornell.edu/~shmat/">http://www.cs.cornell.edu/~shmat/</a>

&nbsp;

<table width="679">
<tbody>
<tr>
<td width="89">Rubric</td>
<td width="408"></td>
<td width="109">Points</td>
<td width="72">Totals

‚úì
</td>
</tr>
<tr>
<td width="89">1.</td>
<td width="408">Warmup Exercises</td>
<td width="109">30</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">i.</td>
<td width="408">Activity 1: Input Value</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">ii.</td>
<td width="408">Activity 1: Javascript File</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">iii.</td>
<td width="408">Activity 1: Function Output</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">iv.</td>
<td width="408">Activity 2: HTTP Verb</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">v.</td>
<td width="408">Activity 2: Status Code</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">vi.</td>
<td width="408">Activity 2: Cookie Value</td>
<td width="109">2</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">vii.</td>
<td width="408">Activity 3: activity3.html</td>
<td width="109">5</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">x.</td>
<td width="408">Activity 4: activity4.html</td>
<td width="109">5</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">xi.</td>
<td width="408">Activity 5: activity5.html</td>
<td width="109">8</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">2.</td>
<td width="408">XSRF</td>
<td width="109">20</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">i.</td>
<td width="408">Partial Credit Only: You see the ‚ÄúXSRF prevented‚Äù message with your exploit but did not accomplish the update.</td>
<td width="109">10 out of 20 pts</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">3.</td>
<td width="408">XSS Username and Password Theft</td>
<td width="109">25</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">i.</td>
<td width="408">Partial Credit Only: Can inject a script and send an email to the user account but did not accomplish stealing the correct credentials.</td>
<td width="109">10 out of 25 pts</td>
<td width="72"></td>
</tr>
<tr>
<td width="89">4</td>
<td width="408">SQL Injection</td>
<td width="109">25</td>
<td width="72"></td>
</tr>
</tbody>
</table>
&nbsp;
